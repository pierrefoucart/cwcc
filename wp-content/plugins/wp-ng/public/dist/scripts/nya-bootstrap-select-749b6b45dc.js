!function(){"use strict";function e(){return++c}function t(e){return e&&e.window===e}function n(e){return"string"==typeof e}function a(e){if(null==e||t(e))return!1;var a=e.length;return!(1!==e.nodeType||!a)||(n(e)||Array.isArray(e)||0===a||"number"==typeof a&&a>0&&a-1 in e)}function l(){return Object.create(null)}function r(t,n){var a,l=typeof t;return"function"==l||"object"==l&&null!==t?"function"==typeof(a=t.$$hashKey)?a=t.$$hashKey():void 0===a&&(a=t.$$hashKey=(n||e)()):a=t,l+":"+a}function s(e,t,n){var a,l,r=[],s=[];for(a=0;a<t.length;a++)for(l=0;l<e.length;l++)e[l][n]?e[l][n]===t[a]&&s.push(e[l]):r.push(e[l]);return s=s.concat(r)}function o(e){var t=e[0],n=e[e.length-1],a=[t];do{if(!(t=t.nextSibling))break;a.push(t)}while(t!==n);return angular.element(a)}function i(e,t){for(;(e=e[t])&&1!==e.nodeType;);return e}var c=0,d=function(e){return e.clone[0]},u=function(e){return e.clone[e.clone.length-1]},p=function(e,t,n,a,l,r,s,o){e[n]=a,l&&(e[l]=r),e.$index=t,e.$first=0===t,e.$last=t===s-1,e.$middle=!(e.$first||e.$last),e.$odd=!(e.$even=0==(1&t)),o&&(e.$group=o)},f=function(e,t){e.data("isolateScope",t)},h=function(e,t){var n,a=e.length;if(0===a)return!1;for(n=0;n<a;n++)if(S(t,e[n]))return!0;return!1},v=function(e,t){var n,a=e.length;if(0===a)return-1;for(n=0;n<a;n++)if(S(t,e[n]))return n;return-1},g=function(e,t,n){var a,l=e,r=typeof n;if(e==t)return null;do{if("string"===r){if(a=" "+l.className+" ",1===l.nodeType&&a.replace(/[\t\r\n\f]/g," ").indexOf(n)>=0)return l}else if(l==n)return l}while((l=l.parentNode)&&l!=t&&9!==l.nodeType);return null},C=function(e){var t;t=e.className.replace(/[\t\r\n\f]/g," ").trim().split(" ");for(var n=0;n<t.length;n++)/\s+/.test(t[n])&&(t.splice(n,1),n--);return t},m=function(e,t){return-1!==C(e).indexOf(t)},y=function(e,t){var n,a,l;if(-1!==e.text().toLowerCase().indexOf(t.toLowerCase()))return!0;for(n=e.children(),l=n.length,a=0;a<l;a++)if(-1!==n.eq(a).text().toLowerCase().indexOf(t.toLowerCase()))return!0;return!1},b=angular.element,S=angular.equals,$=angular.copy,w=angular.extend,T=angular.module("nya.bootstrap.select",[]);T.provider("nyaBsConfig",function(){var e=null,t={"en-us":{defaultNoneSelection:"Nothing selected",noSearchResult:"NO SEARCH RESULT",numberItemSelected:"%d items selected",selectAll:"Select All",deselectAll:"Deselect All"}},n=$(t);this.setLocalizedText=function(e,t){if(!e)throw new Error("localeId must be a string formatted as languageId-countryId");n[e]||(n[e]={}),n[e]=w(n[e],t)},this.useLocale=function(t){e=t},this.$get=["$locale",function(a){var l;return l=e?n[e]:n[a.id],l||(l=t["en-us"]),l}]}),T.controller("nyaBsSelectCtrl",function(){var e=this;e.keyIdentifier=null,e.valueIdentifier=null,e.isMultiple=!1,e.onCollectionChange=function(){},e.setId=function(t){e.id=t||"id#"+Math.floor(1e4*Math.random())}}),T.directive("nyaBsSelect",["$parse","$document","$timeout","$compile","nyaBsConfig",function(e,t,n,a,l){var r='<li class="no-search-result"><span>NO SEARCH RESULT</span></li>',s='<div class="bs-actionsbox"><div class="btn-group btn-group-sm btn-block"><button type="button" class="actions-btn bs-select-all btn btn-default">SELECT ALL</button><button type="button" class="actions-btn bs-deselect-all btn btn-default">DESELECT ALL</button></div></div>';return{restrict:"ECA",require:["ngModel","nyaBsSelect"],controller:"nyaBsSelectCtrl",compile:function(o,c){o.addClass("btn-group");var d,u,p,f,w,T,x,A,q=o.children(),E=b('<button class="btn btn-default dropdown-toggle" type="button"><span class="pull-left filter-option"></span><span class="pull-left special-title"></span>&nbsp;<span class="caret"></span></button>'),N=b('<div class="dropdown-menu open"></div>'),L=b('<ul class="dropdown-menu inner"></ul>'),k=l,I=void 0!==c.multiple;for(f=C(o[0]),f.forEach(function(e){/btn-(?:primary|info|success|warning|danger|inverse)/.test(e)&&(o.removeClass(e),E.removeClass("btn-default"),E.addClass(e)),/btn-(?:lg|sm|xs)/.test(e)&&(o.removeClass(e),E.addClass(e))}),L.append(q),w=q.length,T=0;T<w;T++)x=q.eq(T),(x.hasClass("nya-bs-option")||x.attr("nya-bs-option"))&&(x.find("a").attr("tabindex","0"),A=x.attr("value"),angular.isString(A)&&""!==A&&(x.attr("data-value",A),x.removeAttr("value")));return"true"===c.liveSearch&&(d=b('<div class="bs-searchbox"><input type="text" class="form-control"></div>'),c.noSearchTitle?r=r.replace("NO SEARCH RESULT",c.noSearchTitle):c.noSearchTitleTpl?r=r.replace("NO SEARCH RESULT",c.noSearchTitleTpl):k.noSearchResultTpl?r=r.replace("NO SEARCH RESULT",k.noSearchResultTpl):k.noSearchResult&&(r=r.replace("NO SEARCH RESULT",k.noSearchResult)),u=b(r),N.append(d),L.append(u)),"true"===c.actionsBox&&I&&(k.selectAllTpl?s=s.replace("SELECT ALL",k.selectAllTpl):k.selectAll&&(s=s.replace("SELECT ALL",k.selectAll)),k.deselectAllTpl?s=s.replace("DESELECT ALL",k.deselectAllTpl):k.selectAll&&(s=s.replace("DESELECT ALL",k.deselectAll)),p=b(s),N.append(p)),b(E[0].querySelector(".special-title")).append(function(e){var t;return t=c.titleTpl?b(c.titleTpl):c.title?document.createTextNode(c.title):k.defaultNoneSelectionTpl?b(k.defaultNoneSelectionTpl):k.defaultNoneSelection?document.createTextNode(k.defaultNoneSelection):document.createTextNode("Nothing selected"),e&&(c.titleTpl||k.defaultNoneSelectionTpl)?a(t)(e):t}()),N.append(L),o.append(E),o.append(N),function(l,r,s,o){function c(){var e,t,n=P.children(),a=n.length;for(e=0;e<a;e++)if(t=n.eq(e),t.hasClass("active")&&t.hasClass("nya-bs-option")&&!t.hasClass("not-match"))return t;return null}function d(e){for(var t,n=e.childNodes,a=n.length,l=0;l<a;l++)if(t=n[l],1===t.nodeType&&"a"===t.tagName.toLowerCase()){t.focus();break}}function u(e){var t;t=e?P.children().eq(0):P.children().eq(P.children().length-1);for(var n=0;n<P.children().length;n++){var a=P.children().eq(n);if(!a.hasClass("not-match")&&a.hasClass("selected"))return P.children().eq(n)[0]}return!t.hasClass("nya-bs-option")||t.hasClass("disabled")||t.hasClass("not-match")?e?p(t[0],"nextSibling"):p(t[0],"previousSibling"):t[0]}function p(e,t){if(!e||m(e,"nya-bs-option")){for(var n=e;(n=i(n,t))&&n.nodeType;)if(m(n,"nya-bs-option")&&!m(n,"disabled")&&!m(n,"not-match"))return n;return null}}function f(e){if(V&&!R){var t,n,a;if(t=P[0].querySelectorAll(".nya-bs-option"),t.length>0){n=L.$viewValue,a=Array.isArray(n)?$(n):[];for(var r=0;r<t.length;r++){var s=b(t[r]);if(!s.hasClass("disabled")){var o,i;o=w(s),void 0!==o&&(i=v(a,o),e&&-1==i?(a.push(o),s.addClass("selected")):e||-1==i||(a.splice(i,1),s.removeClass("selected")))}}L.$setViewValue(a),l.$digest(),x()}}}function C(e){var t,n,a,s=L.$viewValue;t=w(e),void 0!==t&&(V?(n=Array.isArray(s)?$(s):[],a=v(n,t),-1===a?(n.push(t),e.addClass("selected")):(n.splice(a,1),e.removeClass("selected"))):(P.children().removeClass("selected"),n=t,e.addClass("selected"))),L.$setViewValue(n),l.$digest(),V||(r.hasClass("open")&&r.triggerHandler("blur"),r.removeClass("open"),B[0].focus()),x()}function w(e){var t;return N?(t=e.data("isolateScope"),N(t)):I.valueIdentifier||I.keyIdentifier?(t=e.data("isolateScope"),t[I.valueIdentifier]||t[I.keyIdentifier]):e.attr("data-value")}function T(e){var t=e.find("a");return 0===t.children().length||t.children().eq(0).hasClass("check-mark")?t[0].firstChild.cloneNode(!1):t.children().eq(0)[0].cloneNode(!0)}function x(){var e=L.$viewValue;r.triggerHandler("change");var t=b(B[0].querySelector(".filter-option"));b(B[0].querySelector(".special-title"));if(void 0===e)return B.addClass("show-special-title"),void t.empty();V&&0===e.length?(B.addClass("show-special-title"),t.empty()):(B.removeClass("show-special-title"),n(function(){var n,l,r,o,i,c,d,u=P.children(),p=u.length,f=[],v=[];if(V&&"count"===s.selectedTextFormat?c=1:V&&s.selectedTextFormat&&(i=s.selectedTextFormat.match(/\s*count\s*>\s*(\d+)\s*/))&&(c=parseInt(i[1],10)),void 0!==c&&e.length>c)return t.empty(),void(k.numberItemSelectedTpl?t.append(b(k.numberItemSelectedTpl.replace("%d",e.length))):k.numberItemSelected?t.append(document.createTextNode(k.numberItemSelected.replace("%d",e.length))):t.append(document.createTextNode(e.length+" items selected")));for(r=0;r<p;r++)l=u.eq(r),l.hasClass("nya-bs-option")&&(n=w(l),V?Array.isArray(e)&&h(e,n)&&(o=l.attr("title"),o?f.push(document.createTextNode(o)):(f.push(T(l)),v.push(l.data("isolateScope")))):S(e,n)&&(o=l.attr("title"),o?f.push(document.createTextNode(o)):(f.push(T(l)),v.push(l.data("isolateScope")))));if(0===f.length)t.empty(),B.addClass("show-special-title");else if(1===f.length)B.removeClass("show-special-title"),t.empty(),d=v[0]?a(f[0])(v[0]):f[0],t.append(d);else for(B.removeClass("show-special-title"),t.empty(),r=0;r<f.length;r++)d=v[r]?a(f[r])(v[r]):f[r],t.append(d),r<f.length-1&&t.append(document.createTextNode(", "))}))}function A(){var e,t,n=P.find("li"),a=n.length;for(t=0;t<a;t++)if(e=n.eq(t),e.hasClass("nya-bs-option")||e.attr("nya-bs-option")){q=e[0].clientHeight;break}if(/\d+/.test(s.size)){var l=parseInt(s.size,10);P.css("max-height",l*q+"px"),P.css("overflow-y","auto")}}var q,E,N,L=o[0],I=o[1],R=!1,O=e(I.valueExp),V=void 0!==s.multiple,B=b(r[0].querySelector(".dropdown-toggle")),H=B.next(),P=b(H[0].querySelector(".dropdown-menu.inner")),D=b(H[0].querySelector(".bs-searchbox")),M=b(P[0].querySelector(".no-search-result")),U=b(H[0].querySelector(".bs-actionsbox"));I.valueExp&&(N=function(e,t){return O(e,t)}),I.setId(r.attr("id")),V&&(I.isMultiple=!0,L.$isEmpty=function(e){return!e||0===e.length}),void 0!==s.disabled&&l.$watch(s.disabled,function(e){e?(B.addClass("disabled"),B.attr("disabled","disabled"),E=B.attr("tabindex"),B.attr("tabindex","-1"),R=!0):(B.removeClass("disabled"),B.removeAttr("disabled"),E?B.attr("tabindex",E):B.removeAttr("tabindex"),R=!1)}),I.onCollectionChange=function(e,t){var n,a=[],r=!1,s=$(L.$modelValue);if(s){if(Array.isArray(e)&&e.length>0){if(N)for(n=0;n<e.length;n++)a.push(N(l,e[n]));else for(n=0;n<e.length;n++)I.valueIdentifier?a.push(e[n][I.valueIdentifier]):I.keyIdentifier&&a.push(e[n][I.keyIdentifier]);if(V){for(n=0;n<s.length;n++)h(a,s[n])||(r=!0,s.splice(n,1),n--);r&&(L.$setViewValue(s),x())}else h(a,s)||(s=a[0],L.$setViewValue(s),x())}t&&x()}},P.on("click",function(e){if(!R&&!b(e.target).hasClass("dropdown-header")){var t,n=g(e.target,P[0],"nya-bs-option");if(null!==n){if(t=b(n),t.hasClass("disabled"))return;C(t)}}});var z=function(e){null===g(e.target,r.parent()[0],r[0])&&(r.hasClass("open")&&r.triggerHandler("blur"),r.removeClass("open"))};t.on("click",z),B.on("blur",function(){r.hasClass("open")||r.triggerHandler("blur")}),B.on("click",function(){var e;r.toggleClass("open"),r.hasClass("open")&&void 0===q&&A(),"true"===s.liveSearch&&r.hasClass("open")?(D.children().eq(0)[0].focus(),(e=u(!0))&&(P.children().removeClass("active"),b(e).addClass("active"))):r.hasClass("open")&&(e=u(!0))&&d(e)}),"true"===s.actionsBox&&V&&(U.find("button").eq(0).on("click",function(){f(!0)}),U.find("button").eq(1).on("click",function(){f(!1)})),"true"===s.liveSearch&&D.children().on("input",function(){var e,t,n,a=D.children().val(),l=0,r=P.children(),s=r.length;if(a){for(e=0;e<s;e++)t=r.eq(e),t.hasClass("nya-bs-option")&&(y(t.find("a"),a)?(t.removeClass("not-match"),l++):t.addClass("not-match"));0===l?M.addClass("show"):M.removeClass("show")}else{for(e=0;e<s;e++)t=r.eq(e),t.hasClass("nya-bs-option")&&t.removeClass("not-match");M.removeClass("show")}(n=u(!0))&&(r.removeClass("active"),b(n).addClass("active"))}),L.$render=function(){var e,t,n=L.$modelValue,a=P.children(),l=a.length;if(void 0===n)for(e=0;e<l;e++)a.eq(e).hasClass("nya-bs-option")&&a.eq(e).removeClass("selected");else for(e=0;e<l;e++)a.eq(e).hasClass("nya-bs-option")&&(t=w(a.eq(e)),V?h(n,t)?a.eq(e).addClass("selected"):a.eq(e).removeClass("selected"):S(n,t)?a.eq(e).addClass("selected"):a.eq(e).removeClass("selected"));x()},r.on("keydown",function(e){var t=e.keyCode;if(27===t||13===t||38===t||40===t){if(e.preventDefault(),R)return void e.stopPropagation();var n,a,l,o,i=g(e.target,r[0],B[0]);"true"===s.liveSearch?a=g(e.target,r[0],D[0]):n=g(e.target,r[0],H[0]),i?13!==t&&38!==t&&40!==t||r.hasClass("open")||(e.stopPropagation(),r.addClass("open"),void 0===q&&A(),"true"===s.liveSearch?(D.children().eq(0)[0].focus(),(o=u(!0))&&(P.children().removeClass("active"),b(o).addClass("active"))):(o=u(!0))&&d(o)):n?27===t?(B[0].focus(),r.hasClass("open")&&r.triggerHandler("blur"),r.removeClass("open"),e.stopPropagation()):38===t?(e.stopPropagation(),o=p(e.target.parentNode,"previousSibling"),o?d(o):(o=u(!1))&&d(o)):40===t?(e.stopPropagation(),o=p(e.target.parentNode,"nextSibling"),o?d(o):(o=u(!0))&&d(o)):13===t&&(e.stopPropagation(),l=b(e.target.parentNode),l.hasClass("nya-bs-option")&&(C(l),V||B[0].focus())):a&&(27===t?(B[0].focus(),r.removeClass("open"),e.stopPropagation()):38===t?(e.stopPropagation(),(l=c())&&(o=p(l[0],"previousSibling"),o?(l.removeClass("active"),b(o).addClass("active")):(o=u(!1))&&(l.removeClass("active"),b(o).addClass("active")))):40===t?(e.stopPropagation(),(l=c())&&(o=p(l[0],"nextSibling"),o?(l.removeClass("active"),b(o).addClass("active")):(o=u(!0))&&(l.removeClass("active"),b(o).addClass("active")))):13===t&&(l=c())&&(C(l),V||B[0].focus()))}}),l.$on("$destroy",function(){P.off(),B.off(),D.off&&D.off(),t.off("click",z)})}}}}]),T.directive("nyaBsOption",["$parse",function(e){return{restrict:"A",transclude:"element",priority:1e3,terminal:!0,require:["^nyaBsSelect","^ngModel"],compile:function(t,n){var i=n.nyaBsOption,c=document.createComment(" end nyaBsOption: "+i+" "),v=i.match(/^\s*(?:([\$\w][\$\w]*)|(?:\(\s*([\$\w][\$\w]*)\s*,\s*([\$\w][\$\w]*)\s*\)))\s+in\s+([\s\S]+?)(?:\s+group\s+by\s+([\s\S]+?))?(?:\s+track\s+by\s+([\s\S]+?))?\s*$/);if(!v)throw new Error("invalid expression");var g,C,m,y,$,w=n.value,T=w?e(w):null,x=v[3]||v[1],A=v[2],q=v[4],E=v[5]?e(v[5]):null,N=v[6],L={$id:r},k={};return N?y=e(N):(g=function(e,t){return r(t)},C=function(e){return e}),function(e,t,n,r,i){function v(e){var n,r,v,y,w,T,q,E,L,k,V,H,P,D,M,U=t[0],z=l(),F=[];if($&&(H=[]),a(e))T=e,w=m||g;else{w=m||C,T=[];for(var K in e)e.hasOwnProperty(K)&&"$"!=K.charAt(0)&&T.push(K);T.sort()}for(q=T.length,E=new Array(q),n=0;n<q;n++)if(r=e===T?n:T[n],v=e[r],y=w(r,v,n),M={},A&&(M[A]=r),M[x]=v,F.push(M),$&&(k=$(r,v),-1===H.indexOf(k)&&k&&H.push(k)),B[y])L=B[y],delete B[y],$&&(L.group=k),L.key=r,L.value=v,z[y]=L,E[n]=L;else{if(z[y])throw E.forEach(function(e){e&&e.scope&&(B[e.id]=e)}),new Error("Duplicates in a select are not allowed. Use 'track by' expression to specify unique keys.");E[n]={id:y,scope:void 0,clone:void 0,key:r,value:v},z[y]=!0,k&&(E[n].group=k)}H&&H.length>0&&(E=s(E,H,"group"));for(var j in B)L=B[j],D=o(L.clone),D.removeData("isolateScope"),D.remove(),L.scope.$destroy();for(n=0;n<q;n++)L=E[n],L.scope?(V=U,d(L)!=V&&b(U).after(L.clone),U=u(L),p(L.scope,n,x,L.value,A,L.key,q,L.group)):i(function(e,t){f(e,t),L.scope=t;var a=c.cloneNode(!1);e[e.length++]=a,b(U).after(e),e.addClass("nya-bs-option"),v=N?N(L.key,L.value):L.value||L.key,R.isMultiple?Array.isArray(O.$modelValue)&&h(O.$modelValue,v)&&e.addClass("selected"):S(v,O.$modelValue)&&e.addClass("selected"),U=a,L.clone=e,z[L.id]=L,p(L.scope,n,x,L.value,A,L.key,q,L.group)}),H&&(P&&P===L.group?L.clone.removeClass("first-in-group"):L.clone.addClass("first-in-group"),P=L.group,L.clone.addClass("group-item"));B=z,R.onCollectionChange(F,I)}var N,I,R=r[0],O=r[1],V={};y&&(m=function(t,n,a){return A&&(L[A]=t),L[x]=n,L.$index=a,y(e,L)}),E&&($=function(t,n){return A&&(k[A]=t),k[x]=n,E(e,k)}),A&&(R.keyIdentifier=A),x&&(R.valueIdentifier=x),T&&(R.valueExp=w,N=function(t,n){return A&&(V[A]=t),V[x]=n,T(e,V)});var B=l();"true"===n.deepWatch?(I=!0,e.$watch(q,v,!0)):(I=!1,e.$watchCollection(q,v))}}}}])}();